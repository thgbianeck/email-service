# .docker/Makefile

# Definir diretÃ³rio raiz do projeto
PROJECT_ROOT = ..

.PHONY: build run stop test clean logs restart prod help

help:
    @echo "ğŸ“‹ Comandos disponÃ­veis:"
    @echo "  build     - Construir imagem Docker"
    @echo "  run       - Executar aplicaÃ§Ã£o em desenvolvimento"
    @echo "  stop      - Parar aplicaÃ§Ã£o"
    @echo "  test      - Executar testes"
    @echo "  clean     - Limpar recursos Docker"
    @echo "  logs      - Mostrar logs da aplicaÃ§Ã£o"
    @echo "  restart   - Reiniciar aplicaÃ§Ã£o"
    @echo "  prod      - Deploy em produÃ§Ã£o"

build:
    @echo "ğŸ—ï¸ Construindo imagem Docker..."
    cd $(PROJECT_ROOT) && docker build -f .docker/Dockerfile -t viasoft/email-service:latest .

run:
    @echo "ğŸš€ Iniciando aplicaÃ§Ã£o..."
    cd $(PROJECT_ROOT) && docker-compose -f .docker/docker-compose.yml up -d

stop:
    @echo "ğŸ›‘ Parando aplicaÃ§Ã£o..."
    cd $(PROJECT_ROOT) && docker-compose -f .docker/docker-compose.yml down

test:
    @echo "ğŸ§ª Executando testes..."
    cd $(PROJECT_ROOT) && mvn clean test

clean:
    @echo "ğŸ§¹ Limpando recursos Docker..."
    docker system prune -f

logs:
    @echo "ğŸ“‹ Mostrando logs..."
    cd $(PROJECT_ROOT) && docker-compose -f .docker/docker-compose.yml logs -f email-service

restart: stop run

prod:
    @echo "ğŸš€ Deploy em produÃ§Ã£o..."
    cd $(PROJECT_ROOT) && docker-compose -f .docker/docker-compose.prod.yml up -d --build